name: Extract File References

on:
  workflow_dispatch:
    inputs:
      test_file:
        description: 'Ruta del archivo de prueba'
        required: true
        default: 'cypress/e2e/Tests/API/Cards/GX3-5811-boardMembers.api.cy.ts'

jobs:
  extract-references:
    runs-on: ubuntu-latest

    steps:
    - name: Check out repository
      uses: actions/checkout@v2

    - name: 🍙 Setup Bun
      uses: oven-sh/setup-bun@v2
      with:
        bun-version: latest

    - name: 🧬 Install Dependencies
      run: bun install

    - name: 📜 Execute Extract References Script
      id: run-script
      run: |
        # Ejecuta el script de extracción de referencias en TypeScript
        bun run scripts/extractReferences.ts "${{ github.event.inputs.test_file }}" > extracted_references.json

        # Mostrar el contenido de las referencias extraídas
        cat extracted_references.json
        echo "Referencias extraídas completadas"

    - name: 📦 Upload Extracted References
      uses: actions/upload-artifact@v4
      with:
        name: extracted-references
        path: extracted_references.json
        retention-days: 7

